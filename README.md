
# Carbyne Home Assignment – Emergency Alerts API

This project is a **Rules & Alert API** built with **Node.js**, **Express.js**, and **SQLite**. It allows emergency services to define response rules, process incoming call data, and automatically generate alerts when specific keywords are detected in call transcripts.


## Background

> This project was created as a technical assessment for Carbyne.
> I was tasked by Carbyne to demonstrate learning speed, code organization, and API fundamentals.

## Implementation Details
In this assignment, I implemented the following:

    Core Logic: Full CRUD for rules, call ingestion, and an automated alerting engine.

    Extra Credit 1 (Rule Management): implemented a PATCH endpoint to allow dynamic updates to rules and a way to toggle them on/off without deletion.

    Extra Credit 2 (Idempotency): implemented Idempotency for creating calls to avoid duplicate requests.

## Installation & Setup

1. **Clone the repository:**
```bash
git clone https://github.com/Aloncvt/carbyne-home-assignment.git
cd carbyne-home-assignment
```


2. **Install dependencies:**
```bash
npm install
```

3. **Start the server:**
```bash
npm start
```


*The server will run on `http://localhost:3000` by default.*

## Project Structure

```text
carbyne-home-assignment
├── server.js          # Express application, 
├── database.js        # SQLite schema 
├── database.db        # SQLite database file 
├── package.json       # Dependencies, scripts, and project metadata
└── README.md          # Documentation
```


## API Documentation

### 1. Rules Management

Rules define which keywords trigger alerts.

* **Create a Rule** (`POST /rules`)
```json
{
  "name": "Fire Department",
  "keywords": ["fire", "smoke", "burning"],
  "enabled": true
}

```


* **List Rules** (`GET /rules?enabled=true`)
* **Update Rule** (`PATCH /rules/:id`)
*Use this endpoint to toggle a rule's status or update keywords.*

### 2. Call Processing

Ingest call data and check against enabled rules.

* **Process a Call** (`POST /calls`)
* **Header:** `Idempotency-Key: <unique_string>`
* **Body:**


```json
{
  "timestamp": "2026-01-17T15:00:00Z",
  "phone": "100",
  "location": "Yigal Alon Street 94",
  "transcript": "I see smoke and a small fire!"
}

```



### 3. Alerts Retrieval

Retrieve alerts generated by the matching engine.

* **Get Alerts** (`GET /alerts`)
* **Filters:** `ruleId`, `callId`


## Key Features

* **Avoids Duplicate Alerts**: Supports an `Idempotency-Key` header so the same call wont trigger multiple alerts if retried.
* **Smart Keyword Matching**: Checks call transcripts against all active rules in a case insensitive way.
* **Persistent Storage**: Stores rules, calls, and alerts in SQLite, so data isnt lost when the server restarts.
* **Clean Modern Code**: Written in ES Modules (`import/export`) with readable, well organized functions.

## Author

* **[Alon](https://www.google.com/search?q=https://github.com/Aloncvt)**
